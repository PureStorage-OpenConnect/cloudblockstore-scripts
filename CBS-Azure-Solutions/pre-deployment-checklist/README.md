# Azure Pre-Deployment Checklist for Cloud Block Store

![paz-checklist.ps1 script to validate Azure landing zone for CBS deployment](screenshot.png)

## Usage

To run this PowerShell script, make sure you are signed in to your Azure account. Alternatively, use can Azure Cloud Shell.

By default a VM Name will be autogenerated, if you need to change the name or add tags please use `tempVMName` or `tempVmTags` attributes

By default the VM will be deployed with an Ubuntu OS and the Standard_B1s vm size. if you need to change the OS or Size please use `tempVmOS` and `tempVmSize` attributes

### Option 1 - Use Azure Cloud Shell

1. Open a Azure Cloud Shell console and make sure you have selected a Powershell runtime (by default the Azure Cloud Shell starts in Bash runtime)

1. Download the script from GitHub (alternatively you can upload manually via Download/Upload files feature)

```powershell
wget https://raw.githubusercontent.com/PureStorage-OpenConnect/cloudblockstore-scripts/main/CBS-Azure-Solutions/pre-deployment-checklist/paz-checklist.ps1
```

1. Replace placeholders (subscription ID, vNET name,...) in the following command example and execute the script

```powershell
./paz-checklist.ps1 -subscriptionId "<<SUBSCRIPTION-ID>>" -cbsModel "V20MP2R2" -cbsVNETName "<<CBS-VNET-NAME>>" -vnetSystemSubnetName "<<SYSTEM-SUBNET-NAME>>"
```

### Option 2 - Local machine

1. Install Azure Powershell Module
1. Login into Azure:

```powershell
Connect-AzAccount
```

1. Replace placeholders (subscription ID, vNET name,...) in the following command example and execute the script

```powershell
./paz-checklist.ps1 -subscriptionId "<<SUBSCRIPTION-ID>>" -cbsModel "V20MP2R2" -cbsVNETName "<<CBS-VNET-NAME>>" -vnetSystemSubnetName "<<SYSTEM-SUBNET-NAME>>"
```

This script will validate and verify the following:

- Check if the region where VNET is created is supported for CBS deployments.
- Check if the region has enough vCPU Quota to deploy Cloud Block Store.
- Check if there are any region or zonal restrictions on the instance.
- Check if the PremiumV2 or Ultra Disks are available and in which Availability Zone.
- Check if the System Subnet has outbound internet access to Pure1 cloud.
- Check if the Signed In User has the required Azure Role Assignment.